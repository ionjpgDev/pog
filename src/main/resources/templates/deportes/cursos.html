<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${titulo}">Cursos del Deporte</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" th:href="@{/}">üè´ Escuelas Deportivas</a>
        </div>
    </nav>

    <!-- Content -->
    <div class="container my-5">
        <div id="cursos-container">
            <!-- Cargando -->
            <div class="text-center">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Cargando...</span>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Obtener ID del deporte de la URL
        const pathParts = window.location.pathname.split('/');
        const deporteId = pathParts[pathParts.length - 1];
        
        // Cargar cursos del deporte
        fetch(`/api/deportes/${deporteId}/cursos`)
            .then(response => response.json())
            .then(data => {
                const container = document.getElementById('cursos-container');
                
                if (data.cursos && data.cursos.length > 0) {
                    container.innerHTML = `
                        <h1 class="mb-4">Cursos de ${data.deporteNombre}</h1>
                        <div class="row" id="cursos-list"></div>
                    `;
                    
                    const cursosList = document.getElementById('cursos-list');
                    data.cursos.forEach(curso => {
                        const cursoCard = document.createElement('div');
                        cursoCard.className = 'col-md-4 mb-4';
                        cursoCard.innerHTML = `
                            <div class="card h-100">
                                <div class="card-body">
                                    <h5 class="card-title">${curso.nombre}</h5>
                                    <p class="card-text">
                                        <strong>Instructor:</strong> ${curso.instructor}<br>
                                        <strong>Horario:</strong> ${curso.horario}<br>
                                        <strong>Cupo:</strong> ${curso.cupoActual}/${curso.cupoMaximo}
                                    </p>
                                    <a href="/curso/detalle/${curso.id}" class="btn btn-primary">Ver detalles</a>
                                </div>
                            </div>
                        `;
                        cursosList.appendChild(cursoCard);
                    });
                } else {
                    container.innerHTML = `
                        <div class="alert alert-info">
                            <h4>No hay cursos disponibles para este deporte</h4>
                            <p>Actualmente no hay cursos activos para este deporte.</p>
                            <a href="/deporte" class="btn btn-primary">Volver a deportes</a>
                        </div>
                    `;
                }
            })
            .catch(error => {
                document.getElementById('cursos-container').innerHTML = `
                    <div class="alert alert-danger">
                        <h4>Error al cargar cursos</h4>
                        <p>${error.message}</p>
                        <a href="/deporte" class="btn btn-primary">Volver a deportes</a>
                    </div>
                `;
            });
    </script>
</body>
</html>