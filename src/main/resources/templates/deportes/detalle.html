<!DOCTYPE html>
<html xmlns:th="http="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${titulo}">Detalle del Deporte</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .detail-card {
            border: none;
            border-radius: 15px;
            overflow: hidden;
        }
        .detail-header {
            padding: 30px;
            color: white;
        }
        .info-item {
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        .stat-badge {
            font-size: 1rem;
            padding: 8px 15px;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" th:href="@{/}">üè´ Escuelas Deportivas</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/}">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/deporte}">Deportes</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/curso}">Cursos</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Detalle del Deporte -->
    <div class="container my-5" id="deporte-container">
        <!-- Se cargar√° din√°micamente -->
        <div class="text-center">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Cargando...</span>
            </div>
            <p class="mt-2">Cargando informaci√≥n del deporte...</p>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4 mt-5">
        <div class="container text-center">
            <p>¬© 2024 Escuelas Deportivas - Proyecto 131</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Obtener ID del deporte de la URL
        const pathParts = window.location.pathname.split('/');
        const deporteId = pathParts[pathParts.length - 1];
        
        // Funci√≥n para cargar detalles del deporte
        function cargarDetalleDeporte() {
            fetch(`/api/deportes/${deporteId}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Deporte no encontrado');
                    }
                    return response.json();
                })
                .then(deporte => {
                    const container = document.getElementById('deporte-container');
                    
                    // Determinar color seg√∫n el tipo
                    const tipoColor = getTipoColor(deporte.tipo);
                    const icon = getSportIcon(deporte.nombre);
                    
                    container.innerHTML = `
                        <div class="row justify-content-center">
                            <div class="col-md-10">
                                <!-- Header -->
                                <div class="detail-card shadow">
                                    <div class="detail-header ${tipoColor.replace('bg-', 'bg-gradient-')}" 
                                         style="background: linear-gradient(135deg, var(--bs-${tipoColor.replace('bg-', '')}), #000);">
                                        <div class="row align-items-center">
                                            <div class="col-md-8">
                                                <h1 class="display-5 mb-3">
                                                    ${icon} ${deporte.nombre}
                                                </h1>
                                                <span class="badge bg-light text-dark fs-6">${deporte.tipo}</span>
                                                <p class="mt-3 mb-0">${deporte.descripcion || 'Descripci√≥n no disponible'}</p>
                                            </div>
                                            <div class="col-md-4 text-end">
                                                <span class="stat-badge bg-white text-dark">
                                                    <i class="fas fa-users"></i> ${deporte.cursos || 0} Cursos
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="card-body">
                                        <div class="row">
                                            <!-- Informaci√≥n Principal -->
                                            <div class="col-md-8">
                                                <h4 class="mb-4"><i class="fas fa-info-circle"></i> Informaci√≥n General</h4>
                                                
                                                <div class="info-item">
                                                    <strong><i class="fas fa-id-card"></i> ID:</strong>
                                                    <span class="ms-2">${deporte.id}</span>
                                                </div>
                                                
                                                <div class="info-item">
                                                    <strong><i class="fas fa-child"></i> Rango de Edad:</strong>
                                                    <span class="ms-2">
                                                        <span class="badge bg-primary">${deporte.edadMinima} a√±os</span>
                                                        <i class="fas fa-arrow-right mx-2"></i>
                                                        <span class="badge bg-primary">${deporte.edadMaxima} a√±os</span>
                                                    </span>
                                                </div>
                                                
                                                <div class="info-item">
                                                    <strong><i class="fas fa-file-medical"></i> Certificado M√©dico:</strong>
                                                    <span class="ms-2">
                                                        <span class="badge ${deporte.requiereCertificado ? 'bg-warning' : 'bg-success'}">
                                                            ${deporte.requiereCertificado ? 'Requerido' : 'No requerido'}
                                                        </span>
                                                    </span>
                                                </div>
                                                
                                                <div class="info-item">
                                                    <strong><i class="fas fa-calendar-alt"></i> Fecha de Registro:</strong>
                                                    <span class="ms-2">${new Date().toLocaleDateString()}</span>
                                                </div>
                                                
                                                <div class="info-item">
                                                    <strong><i class="fas fa-check-circle"></i> Estado:</strong>
                                                    <span class="ms-2">
                                                        <span class="badge ${deporte.activo ? 'bg-success' : 'bg-danger'}">
                                                            ${deporte.activo ? 'Activo' : 'Inactivo'}
                                                        </span>
                                                    </span>
                                                </div>
                                                
                                                <div class="mt-4">
                                                    <h5><i class="fas fa-clipboard-list"></i> Requisitos Adicionales</h5>
                                                    <ul class="list-group list-group-flush">
                                                        <li class="list-group-item">
                                                            <i class="fas ${deporte.requiereEquipo ? 'fa-check text-success' : 'fa-times text-danger'}"></i>
                                                            Equipo especial: ${deporte.requiereEquipo ? 'S√≠' : 'No'}
                                                        </li>
                                                        <li class="list-group-item">
                                                            <i class="fas ${deporte.requiereInscripcion ? 'fa-check text-success' : 'fa-times text-danger'}"></i>
                                                            Inscripci√≥n previa: ${deporte.requiereInscripcion ? 'S√≠' : 'No'}
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                            
                                            <!-- Acciones y Estad√≠sticas -->
                                            <div class="col-md-4">
                                                <div class="card">
                                                    <div class="card-header bg-light">
                                                        <h5 class="mb-0"><i class="fas fa-cogs"></i> Acciones</h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <div class="d-grid gap-2">
                                                            <a href="/deporte/cursos/${deporte.id}" class="btn btn-primary">
                                                                <i class="fas fa-list"></i> Ver Cursos
                                                            </a>
                                                            <button onclick="editarDeporte('${deporte.id}')" class="btn btn-warning">
                                                                <i class="fas fa-edit"></i> Editar
                                                            </button>
                                                            <button onclick="eliminarDeporte('${deporte.id}')" class="btn btn-danger">
                                                                <i class="fas fa-trash"></i> Eliminar
                                                            </button>
                                                            <a href="/deporte" class="btn btn-secondary">
                                                                <i class="fas fa-arrow-left"></i> Volver
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="card mt-3">
                                                    <div class="card-header bg-light">
                                                        <h5 class="mb-0"><i class="fas fa-chart-bar"></i> Estad√≠sticas</h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <div class="text-center">
                                                            <div class="display-6 mb-2">${deporte.cursos || 0}</div>
                                                            <p class="text-muted mb-0">Cursos Activos</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Cursos Relacionados (si hay) -->
                                ${deporte.cursos > 0 ? `
                                <div class="card mt-4">
                                    <div class="card-header bg-info text-white">
                                        <h5 class="mb-0"><i class="fas fa-running"></i> Cursos Disponibles</h5>
                                    </div>
                                    <div class="card-body">
                                        <p>Este deporte tiene ${deporte.cursos} cursos activos. <a href="/deporte/cursos/${deporte.id}">Ver todos los cursos</a></p>
                                    </div>
                                </div>
                                ` : ''}
                            </div>
                        </div>
                    `;
                })
                .catch(error => {
                    document.getElementById('deporte-container').innerHTML = `
                        <div class="alert alert-danger">
                            <h4 class="alert-heading">Error</h4>
                            <p>${error.message}</p>
                            <a href="/deporte" class="btn btn-primary">Volver a la lista</a>
                        </div>
                    `;
                });
        }
        
        // Funciones auxiliares
        function getTipoColor(tipo) {
            const colores = {
                'Equipo': 'bg-primary',
                'Individual': 'bg-success',
                'Contacto': 'bg-danger',
                'Acu√°tico': 'bg-info',
                'Interior': 'bg-warning',
                'Exterior': 'bg-secondary'
            };
            return colores[tipo] || 'bg-dark';
        }
        
        function getSportIcon(nombre) {
            const iconos = {
                'F√∫tbol': '‚öΩ',
                'Baloncesto': 'üèÄ',
                'Nataci√≥n': 'üèä',
                'Tenis': 'üéæ',
                'Voleibol': 'üèê'
            };
            
            for (const [key, value] of Object.entries(iconos)) {
                if (nombre.toLowerCase().includes(key.toLowerCase())) {
                    return value;
                }
            }
            return 'üèÖ';
        }
        
        function editarDeporte(id) {
            alert('Funcionalidad de edici√≥n en desarrollo. ID: ' + id);
            // window.location.href = `/deporte/editar/${id}`;
        }
        
        function eliminarDeporte(id) {
            if (confirm('¬øEst√° seguro de eliminar este deporte? Esta acci√≥n no se puede deshacer.')) {
                fetch(`/deporte/eliminar/${id}`, {
                    method: 'GET'
                })
                .then(response => {
                    if (response.ok) {
                        alert('Deporte eliminado exitosamente');
                        window.location.href = '/deporte';
                    } else {
                        alert('Error al eliminar el deporte');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error al eliminar el deporte');
                });
            }
        }
        
        // Cargar detalles cuando la p√°gina est√© lista
        document.addEventListener('DOMContentLoaded', cargarDetalleDeporte);
    </script>
</body>
</html>